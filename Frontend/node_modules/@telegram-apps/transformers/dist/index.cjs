"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});class u extends Error{constructor(e,r,n){super(typeof r=="object"?r.message:r||e,{cause:typeof r=="object"?r.cause:n}),this.type=e,this.name="TypedError",Object.setPrototypeOf(this,u.prototype)}}function P(t){return t.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`)}function V(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}const R="ERR_INVALID_VALUE",S="ERR_UNEXPECTED_VALUE",w="ERR_UNEXPECTED_TYPE",y="ERR_PARSE";function D(t,e){const r={};for(const n in t){const a=t[n];if(!a)continue;let o,c;typeof a=="function"?(o=n,c=a):[o,c]=a;try{const s=c(e(o));s!==void 0&&(r[n]=s)}catch(s){throw new u(y,`Parser for "${n}" property failed${o===n?"":`. Source field: "${o}"`}`,s)}}return r}function d(t){let e=t;if(typeof e=="string")try{e=JSON.parse(e)}catch(r){throw new u(R,{cause:r})}if(typeof e!="object"||!e||Array.isArray(e))throw new u(S);return e}function i(t,e){return r=>{const n=a=>{if(!(r&&a===void 0))try{return e(a)}catch(o){throw new u(y,{message:`"${t}" transformer failed to parse the value`,cause:o})}};return Object.assign(n,{isValid(a){try{return n(a),!0}catch{return!1}}})}}function l(t,e){return i(e||"object",r=>{const n=d(r);return D(t,a=>n[a])})}function p(t){throw new u(w,`Unexpected value received: ${JSON.stringify(t)}`)}const E=i("boolean",t=>{if(typeof t=="boolean")return t;const e=String(t);if(e==="1"||e==="true")return!0;if(e==="0"||e==="false")return!1;p(t)}),f=i("string",t=>{if(typeof t=="string"||typeof t=="number")return t.toString();p(t)}),m=i("number",t=>{if(typeof t=="number")return t;if(typeof t=="string"){const e=Number(t);if(!Number.isNaN(e))return e}p(t)}),_=i("date",t=>t instanceof Date?t:new Date(m()(t)*1e3));function A(t,e){return i(e||"searchParams",r=>{typeof r!="string"&&!(r instanceof URLSearchParams)&&p(r);const n=typeof r=="string"?new URLSearchParams(r):r;return D(t,a=>{const o=n.get(a);return o===null?void 0:o})})}function g(t){for(const e in t)t[e]=[P(e),t[e]];return t}const T=t=>{const e=m(),r=m(!0),n=f(),a=f(!0),o=E(!0),c=l(g({addedToAttachmentMenu:o,allowsWriteToPm:o,firstName:n,id:e,isBot:o,isPremium:o,languageCode:a,lastName:a,photoUrl:a,username:a}),"User")(!0);return A(g({authDate:_(),canSendAfter:r,chat:l(g({id:e,type:n,title:n,photoUrl:a,username:a}),"Chat")(!0),chatInstance:a,chatType:a,hash:n,queryId:a,receiver:c,startParam:a,signature:n,user:c}),"initData")(t)};function U(t){return/^#[\da-f]{6}$/i.test(t)}function W(t){return/^#[\da-f]{3}$/i.test(t)}function N(t){const e=t.replace(/\s/g,"").toLowerCase();if(U(e))return e;if(W(e)){let n="#";for(let a=0;a<3;a+=1)n+=e[1+a].repeat(2);return n}const r=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((n,a)=>{const o=parseInt(a,10).toString(16);return n+(o.length===1?"0":"")+o},"#")}const O=i("rgb",t=>N(f()(t))),b=i("themeParams",t=>{const e=O(!0);return Object.entries(d(t)).reduce((r,[n,a])=>(r[V(n)]=e(a),r),{})});function h(t){return JSON.stringify(Object.fromEntries(Object.entries(t).map(([e,r])=>[P(e),r])))}const C=t=>{const e=f(),r=f(!0),n=E(!0);return A({botInline:["tgWebAppBotInline",n],defaultColors:["tgWebAppDefaultColors",b(!0)],fullscreen:["tgWebAppFullscreen",n],initData:["tgWebAppData",T(!0)],initDataRaw:["tgWebAppData",r],platform:["tgWebAppPlatform",e],showSettings:["tgWebAppShowSettings",n],startParam:["tgWebAppStartParam",r],themeParams:["tgWebAppThemeParams",b()],version:["tgWebAppVersion",e]},"launchParams")(t)};function L(t){const{initDataRaw:e,startParam:r,showSettings:n,botInline:a,fullscreen:o,defaultColors:c}=t,s=new URLSearchParams;return s.set("tgWebAppPlatform",t.platform),s.set("tgWebAppThemeParams",h(t.themeParams)),s.set("tgWebAppVersion",t.version),e&&s.set("tgWebAppData",e),r&&s.set("tgWebAppStartParam",r),typeof n=="boolean"&&s.set("tgWebAppShowSettings",n?"1":"0"),typeof a=="boolean"&&s.set("tgWebAppBotInline",a?"1":"0"),typeof o=="boolean"&&s.set("tgWebAppFullscreen",o?"1":"0"),c&&s.set("tgWebAppDefaultColors",h(c)),s.toString()}const j=l({eventType:f(),eventData:t=>t},"miniAppsMessage");function $(t,e){return i(e||"array",r=>{let n;if(Array.isArray(r))n=r;else if(typeof r=="string")try{const a=JSON.parse(r);Array.isArray(a)&&(n=a)}catch{}return n||p(r),n.map(t)})}const I=i("fn",t=>{if(typeof t=="function")return t;p(t)});function B(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}exports.ERR_INVALID_VALUE=R;exports.ERR_PARSE=y;exports.ERR_UNEXPECTED_TYPE=w;exports.ERR_UNEXPECTED_VALUE=S;exports.array=$;exports.boolean=E;exports.createTransformerGen=i;exports.date=_;exports.fn=I;exports.initData=T;exports.isRGB=U;exports.isRGBShort=W;exports.isRecord=B;exports.launchParams=C;exports.miniAppsMessage=j;exports.number=m;exports.object=l;exports.rgb=O;exports.searchParams=A;exports.serializeLaunchParams=L;exports.serializeThemeParams=h;exports.string=f;exports.themeParams=b;exports.toRGB=N;exports.toRecord=d;
//# sourceMappingURL=index.cjs.map
