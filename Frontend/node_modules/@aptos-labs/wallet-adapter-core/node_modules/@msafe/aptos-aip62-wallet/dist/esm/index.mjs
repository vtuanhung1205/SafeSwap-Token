import{a as i}from"./chunk-KFOJX3V6.mjs";import"./chunk-RV257KMF.mjs";import{AccountAddress as l,Ed25519PublicKey as g,Hex as f,Network as u,Serializer as T,SigningScheme as b}from"@aptos-labs/ts-sdk";import{APTOS_CHAINS as r,AccountInfo as h,UserResponseStatus as M}from"@aptos-labs/wallet-standard";var A="MSafe";function nn(){return typeof window<"u"&&typeof document<"u"&&typeof parent<"u"&&typeof parent.window<"u"&&parent.window!==window}var d=class{constructor(n){this.chains=r;this.features=[];this.address=n.toString(),this.publicKey=new Uint8Array,this.chains=r,this.signingScheme=b.MultiEd25519}},S=class{constructor(n,e){this.iframe=n;this.api=e;this.bellhop=new i}connect(){this.bellhop.connect(this.iframe),this.bellhop.on("connect",async()=>{let n=await this.api.connect();console.log("\u{1F680} ~ MSafeWalletServer ~ on ~ connect:",n),this.bellhop.respond("connectResponse",{address:n})}),this.bellhop.on("signMessage",async n=>{let e=await this.api.signMessage(n);console.log("\u{1F680} ~ MSafeWalletServer ~ on ~ signMessage:",e),this.bellhop.respond("signMessageResponse",e)}),this.bellhop.on("signTransaction",async n=>{let e=await this.api.signTransaction(n);console.log("\u{1F680} ~ MSafeWalletServer ~ on ~ signTransaction:",e),this.bellhop.respond("signTransactionResponse",e)}),this.bellhop.on("submitTransaction",async n=>{let e=await this.api.submitTransaction(n);console.log("\u{1F680} ~ MSafeWalletServer ~ on ~ submitTransaction:",e),this.bellhop.respond("submitTransactionResponse",e)}),this.bellhop.on("signAndSubmitTransaction",async n=>{let e=await this.api.signAndSubmitTransaction(n);console.log("\u{1F680} ~ MSafeWalletServer ~ on ~ signAndSubmitTransaction:",e),this.bellhop.respond("signAndSubmitTransactionResponse",e)})}disconnect(){console.log("\u{1F680} ~ MSafeWalletServer ~ disconnect:"),this.bellhop.disconnect()}changeAccount(n){console.log("\u{1F680} ~ MSafeWalletServer ~ changeAccount:",n),this.bellhop.send("changeAccount",{address:n})}},m=class{constructor(n){this.config=n;this.isAIP62Standard=!0;this.version="1.0.0";this.name=A;this.providerName=A;this.provider=null;this.icon="data:image/png;base64,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";this.chains=r;this.accounts=[];this.bellhop=new i;this.account=async()=>(console.log("\u{1F680} ~ MSafeWallet ~ AptosGetAccountMethod:"),this.getCurrentAccountInfo());this.connect=async()=>(console.log("\u{1F680} ~ MSafeWallet ~ AptosConnectMethod:"),this.getCurrentAccountInfo().then(n=>({status:M.APPROVED,args:n})));this.network=async()=>({name:this.config.network,chainId:this.config.network===u.MAINNET?1:2});this.disconnect=async()=>(console.log("\u{1F680} ~ MSafeWallet ~ disconnect:"),Promise.resolve());this.signMessage=async n=>(console.log("\u{1F680} ~ MSafeWallet ~ signMessage:"),this.bellhop.send("signMessage",n),this.fetch("signMessageResponse"));this.signTransaction=async(n,e)=>(console.log("\u{1F680} ~ MSafeWallet ~ signTransaction:"),this.bellhop.send("signTransaction",{transaction:n,asFeePayer:e}),this.fetch("signTransactionResponse"));this.onAccountChange=async n=>{console.log("\u{1F680} ~ MSafeWallet ~ onAccountChange ~ listener:",n),this.onAccountChangeInput=n};this.onNetworkChange=async n=>{console.log("\u{1F680} ~ MSafeWallet ~ onNetworkChange ~ listener:",n),this.onNetworkChangeInput=n};let{network:e,appId:s,appUrl:a}=this.config,t="https://aptos-testnet.m-safe.io/";e!==u.TESTNET&&(t="https://aptos.m-safe.io/"),s?this.url=`${t}/store/${s}`:this.url=`${t}/store/0?url=${a}`,this.bellhop.connect(),this.bellhop.on("changeAccount",async o=>{if(console.log("\u{1F680} ~ MSafeWallet ~ on ~ changeAccount:",o,this.onAccountChangeInput),this.onAccountChangeInput){let p=o.data.address;this.onAccountChangeInput(new h({address:l.fromString(p),publicKey:new g(p)}))}})}get features(){return{"aptos:connect":{version:"1.0.0",connect:this.connect},"aptos:network":{version:"1.0.0",network:this.network},"aptos:disconnect":{version:"1.0.0",disconnect:this.disconnect},"aptos:signTransaction":{version:"1.0.0",signTransaction:this.signTransaction},"aptos:signAndSubmitTransaction":{version:"1.0.0",signAndSubmitTransaction:this.signAndSubmitTransaction},"aptos:signMessage":{version:"1.0.0",signMessage:this.signMessage},"aptos:onAccountChange":{version:"1.0.0",onAccountChange:this.onAccountChange},"aptos:onNetworkChange":{version:"1.0.0",onNetworkChange:this.onNetworkChange},"aptos:account":{version:"1.0.0",account:this.account}}}async submitTransaction(n){return console.log("\u{1F680} ~ MSafeWallet ~ submitTransaction:"),this.bellhop.send("submitTransaction",{transaction:n}),this.fetch("submitTransactionResponse")}async signAndSubmitTransaction(n,e){if(console.log("\u{1F680} ~ MSafeWallet ~ signAndSubmitTransaction:",n),n.rawTransaction){let a=n,t=new T;a.rawTransaction.serialize(t);let o=f.fromHexInput(t.toUint8Array()).toString();this.bellhop.send("signAndSubmitTransaction",{transaction:n,options:e,content:o})}else this.bellhop.send("signAndSubmitTransaction",{transaction:n,options:e});return await this.fetch("signAndSubmitTransactionResponse")}async getCurrentAccountInfo(){this.bellhop.send("connect");let{address:n}=await this.fetch("connectResponse");return console.log("\u{1F680} ~ MSafeWallet ~ getCurrentAccountInfo ~ address:",n),new h({address:l.fromString(n),publicKey:new g(n)})}async fetch(n){return new Promise(e=>{this.bellhop.fetch(n,s=>{e(s.data)})})}};export{m as MSafeWallet,d as MSafeWalletAccount,A as MSafeWalletName,S as MSafeWalletServer,nn as inMSafeWallet};
//# sourceMappingURL=index.mjs.map